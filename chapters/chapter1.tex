%************************************************
\chapter{Toy Model}\label{ch:toy_model}
%************************************************

In this chapter will be defined the two dimensional $U(1)$ pure gauge theory.
Starting from the lagrangian of classic electrodynamics in a $1+1$ Minkowski space-time and its quantum field theory path integral formulation,
it will be discussed the analytic continuation to euclidean space, the definition of the topological charge and its physical interpetation.
Then, the theory will be extended to a discrete and finite lattice space, and it will be described the method used to compute physical quantities with Monte Carlo simulations.

\section{Theory in the continuum}

In a pure gauge theory, the only dynamic fields are gauge fields.
Since $U(1)$ group has only one generator, there is only one gauge field $A_\mu$.

\subsection*{Minkowski metric}

In a $1+1$ dimensional Minkowski space-time, $A_\mu$ has two components, and $\mu = 0, 1$ are respectively the time and space indices.

The classic lagrangian of the theory is:
\[
    \mathcal L[A] = -\frac{1}{4} F_{\mu\nu}F^{\mu\nu}
\]
with $F_{\mu\nu}(x) \equiv \partial_\mu A_\nu(x) - \partial_\nu A_\mu(x)$.
In natural units, the energy dimension of the gauge field is zero.

The $U(1)$ local gauge transformation is a symmetry of this lagrangian, in fact,
under a transformation $G(x) \equiv e^{i\theta(x)} \in U(1)$,
the gauge field transformation is:
\begin{align*}
    A_\mu(x) \rightarrow A'_\mu(x) &= G(x) A_\mu(x) G^{-1}(x) - \frac{i}{g} G(x) \partial_\mu G^{-1}(x) \\
                                   &= A_\mu(x) - \frac{1}{g} \partial_\mu \theta(x)
\end{align*}
where $g$ is the coupling constant, and it has energy dimension equal to one.

The action is: \[ S[A] = \int \mathrm d^2x\, \mathcal L[A(x)] \] and the expectation value of an operator $\widehat{\mathcal O}[A]$ is:
\[
    \left< \widehat{\mathcal O}[A] \right> = \frac{\int[\mathrm dA]\, \mathcal O[A] e^{iS[A]}}{\int[\mathrm dA]\,e^{iS[A]}}
\]
where the integrals are path integrals over field configurations.
In this formulation, field configurations are multiplied by a complex exponential.
When the intent is to compute expectation values via Monte Carlo simulations,
it is necessary to sample configurations from probability density functions.
In this theory, the integrands can be made real and positive switching the theory to euclidean metric performing a Wick rotation of the time coordinate and an analytic continuation of expectation values.

\subsection*{Euclidean metric}

Indicating with the index $M$ the objects defined in Minkowski space and with $E$ the ones in the euclidean, the Wick rotation:
\begin{align*}
    &\begin{dcases}
        x^M_0 &\rightarrow -i x^E_2 \\
        x^M_1 &\rightarrow x^E_1
    \end{dcases}%
    &%
    \begin{dcases}
        A^M_0 &\rightarrow i A^E_2 \\
        A^M_1 &\rightarrow A^E_1 
    \end{dcases}&
\end{align*}
induce the following transformation of the action:
\begin{equation}\label{eq:cont_action}
    S^M[A] = -\frac{1}{4}\int\mathrm d^2x^M\,F^M_{\mu\nu}F_M^{\mu\nu} \rightarrow  S^E[A] = \frac{i}{4}\int\mathrm d^2x\,F^E_{\mu\nu}F^E_{\mu\nu}
\end{equation}
Thus, the expectation value of an operator $\widehat{\mathcal O}[A]$ is:
\begin{equation}\label{eq:cont_exp}
    \left< \widehat{\mathcal O}[A] \right> = \frac{\int[\mathrm dA]\, \mathcal O[A] e^{-S^E[A]}}{\int[\mathrm dA]\,e^{-S^E[A]}}
\end{equation}
Here, the factor $e^{-S[A]}$ is real and positive, and can be enterpreted as a probability density function of field configurations.

The Minkowski formulation will not be needed anymore in later discussions.
For this reason, every object will be considered defined in euclidean two dimensional space.

\subsection*{Topological charge}

The gauge field, expressed in a generic gauge $G(x) \equiv e^{i\theta(x)} \in U(1)$ is:
\[
    A^G_\mu(x) \equiv A_\mu(x) - \frac{1}{g}\partial_\mu\theta(x)
\]

Let $S$ be a disk in the space, $\partial S$ its boundary and $R$ its radius.
If $R \to \infty$, the gauge field, evaluated on $\partial S$,
has only the contribution induced by the gauge transformation:
\[
    \lim_{R\to\infty}A^G_\mu(x) = -\frac{1}{g}\partial_\mu\theta(x)
\]
and its circulation integral over the border is:
\[
    \lim_{R\to\infty}\oint\limits_{\partial S}\mathrm dl_\mu\,A^G_\mu(x) = -\frac{1}{g}\oint\limits_{\partial S}\mathrm dl_\mu\partial_\mu\theta(x)
\]

The definition of $\theta(x)$ leaves a further unfixed constant term:
\[
    \theta(x) \rightarrow \theta(x) + 2\pi n, \quad \text{with}\ n \in \mathbb Z
\]
thus, being $\theta(x)$ a conservative function, only the constant term contributes to the circulation integral:
\[
    \lim_{R\to\infty}\oint\limits_{\partial S}\mathrm dl_\mu\,A^G_\mu(x) = \frac{2\pi}{g} Q, \quad \text{with}\ Q \in \mathbb Z \\
\]
where $Q$ is the topological charge.

Applying then Stokes theorem:
\begin{align*}
    Q &= \frac{g}{2\pi}\lim_{R\to\infty}\oint\limits_{\partial S}\mathrm dl_\mu\,A^G_\mu(x) \\
      &= \frac{g}{2\pi}\lim_{R\to\infty}\int\limits_S\mathrm d\vv s\,\cdot \vv\nabla \times \vv A^G(x) \\
      &= \frac{g}{2\pi}\lim_{R\to\infty}\int\limits_S\mathrm d^2x\, \left(\partial_1 A^G_2(x) - \partial_2 A^G_1(x)\right) \\
      &= \frac{g}{2\pi}\lim_{R\to\infty}\int\limits_S\mathrm d^2x\, F^G_{12}(x) \\
      &= \frac{g}{4\pi}\lim_{R\to\infty}\int\limits_S\mathrm d^2x\, \epsilon_{\mu\nu}F^G_{\mu\nu}(x)
\end{align*}
the definition of the topological charge density becomes clear:
\[
    q(x) \equiv \frac{g}{4\pi}\epsilon_{\mu\nu}F_{\mu\nu}(x)
\]
and its integral over all the space is the topological charge is:
\[
    Q = \int\mathrm d^2x\,q(x)
\]

Finally, being $\vv B(x) = \vv\nabla \times \vv A(x)$, the charge density is proportional to the flux of the magnetic field across an infinitesimal surface,
and the total charge is proportional to the total flux.

\section{Lattice formulation}
The goal is to compute physical observables numerically, and the expectation value \eqref{eq:cont_exp} provide a way to do that.
However, both the numerator and the denominator are divergent in the continuum, and it is necessary an integral regularization to isolate the divergent term,
and hence remove it.

The idea of lattice regularization is to define a theory on a discrete space time lattice with the requirement that,
when the lattice becomes finer, the lattice theory approaches to the continuum theory.

The path integrals are then approximated with finite dimensional integrals,
and the continuum expectation value \eqref{eq:cont_exp} is obtained as the continuum limit of the lattice approximated expectation value.

It is then necessary to provide new definition for the action and the topological charge on the lattice,
and they need to converge to the continuum definition when the lattice spacing approaches zero.

Once the lattice theory is defined, it remains to describe how to compute expectation values with Monte Carlo simulations, and how to extrapolate the continuum limit.

%\subsection*{Dimensionless quantities}
%Numerical studies are usually performed with dimensionless parameters because it simplifies result comparisons and the implementation.
%For this reason, it is clearer if this convention is adopted from the beginning of the lattice formulation.
%
%Let $a$ be the lattice spacing in both direction. It has energy dimension $[a] = -1$ and it can be used to define dimensionless quantities.

\subsection*{Gauge invariant objects}

It is convenient to define an action that is already exactly gauge invariant, even when far from the continuum limit.
By doing so, not only it prevents a further bias to be added when extrapolating the continuum limit,
but it is also possible to apply gauge transformations of the fields without modifying the energy of the system.
It will be shown that the latter property is crucial for the performance of the cluster algorithm described in Chapter \ref{ch:cluster}.

To easily implement gauge invariance, it is useful to encapsulate gauge fields inside \emph{Wilson lines}, which are defined over continuous paths in the space.
Let $\mathcal C(x,y)$ be a path that goes from $x$ to $y$. The correspondent Wilson line is:
\[
    U[\mathcal C(x,y)] = e^{ig\int_{\mathcal C(x,y)}\mathrm dz_\mu\,A_\mu(z)} \in U(1)
\]
Under a gauge transformation $G(x) \equiv e^{i\theta(x)}$, the \emph{Wilson line} transformation is:
\begin{equation}\label{eq:path_gauge}
    \begin{aligned}
    U[\mathcal C(x,y)] \rightarrow U'[\mathcal C(x,y)] &= e^{ig\int_{\mathcal C(x,y)}\mathrm dz_\mu\,\left(A_\mu(z) - \frac{1}{g}\partial_\mu\theta(x)\right)} \\
                                                       &= U[\mathcal C(x,y)]\,e^{i(\theta(x) - \theta(y))} \\
                                                       &= G(x)U[\mathcal C(x,y)]G^{-1}(y)
    \end{aligned}
\end{equation}
If the path is closed, the the correspondent Wilson line, \ie a \emph{Wilson loop}, is gauge invariant:
\[
    U[\mathcal C(x,x)] \rightarrow U[\mathcal C(x,x)]
\]

Wilson loops are then the required invariant objects since they can be constructed also on a discrete space,
and the lattice gauge invariant action will be expressed in terms of them.

\subsection*{Lattice sites, links and plaquettes}
Let the two dimensional space be discretized into a squared grid of points, \ie a lattice, and let $a$ be the side of the squares.
A grid point is usually called \emph{site} and its coordinates labelled with an index $n$.
The site of coordinates $n + \hat\mu$ with $\mu \in {1,2}$ corresponds to the point that has the $\mu$th coordinate increased by $a$.

The most elementary path that can be defined on the lattice is a \emph{link},
\ie a straight line of length $a$ that connects two adjacent sites (Figure \ref{fig:links}).
\begin{figure}[!htb]
    \centering
    \rule{3in}{1.5in}
    \caption{Wilson lines over links}
    \label{fig:links}
\end{figure}
The Wilson line evaluated over the link that connects $n$ to $n+\hat\mu$ is:
\begin{equation}\label{eq:link}
    \begin{aligned}
        U_{\hat\mu}(n) &\equiv e^{ig\int_n^{n+\hat\mu}\mathrm dz_\mu\,A_\mu(z)} \\
                       &= e^{ig\int_n^{n+\hat\mu}\mathrm dz_\mu\,\left[A_\mu(n+\hat\mu/2) + (z_\mu-n-\hat\mu/2)\partial_\mu A_\mu(n+\hat\mu/2)%
                                                                                     + \mathcal O\left((z_\mu-n-\hat\mu/2)^2\right)\right]} \\
                       &= e^{ig\left[aA_\mu(n+\hat\mu/2) + \mathcal O\left(a^3\right)\right]}
    \end{aligned}
\end{equation}
Thus, in the limit $a \to 0$, it is related to the gauge field evaluated at the midpoint of the link.
These link Wilson lines are also called \emph{link variables}, and the lattice action will be expressed in terms of them,
encapsulating the gauge fields inside link variables.

If the link path is evaluated in the opposite direction, the value is its complex conjugate (or its inverse):
\[
    U_{-\hat\mu}(n+\hat\mu) = e^{ig\int^n_{n+\hat\mu}\mathrm dz_\mu\,A_\mu(z)} = e^{-ig\int_n^{n+\hat\mu}\mathrm dz_\mu\,A_\mu(z)} = U^*_{\hat\mu}(n)
\]
For a finite lattice, the number of \emph{independent} link variables is then equal to the number of sites multiplied by the number of dimensions.

A local gauge transform $G(n) \in U(1)$ applied to site $n$ affects all links connected to it.
Using Equation \eqref{eq:path_gauge}, the transformation of link variables is:
\begin{equation}\label{eq:site_gauge}
    \begin{aligned}
        &\begin{dcases}
        U_\mu(n) \rightarrow G(n)U_\mu(n) \\
        U_{-\mu}(n) \rightarrow G(n)U_{-\mu}(n)
        \end{dcases}%
        &%
        \begin{dcases}
        U_\mu(n-\hat\mu) \rightarrow U_\mu(n-\hat\mu)G^*(n) \\
        U_{-\mu}(n+\hat\mu) \rightarrow U_{-\mu}(n+\hat\mu)G^*(n)
        \end{dcases}&
    \end{aligned}
\end{equation}
This means that if a link variable is coming from site $n$, it will be multiplied by $G(n)$, but,
if it is going toward site $n$, it will be multiplied by $G^*(n)$.
This kind of gauge transformations is very important for this work because the cluster algorithm described in Chapter \ref{ch:cluster}
will perform a sequence of them before cluster inversion.

Any Wilson line on the lattice can be expressed in terms of link variables,
in fact, decomposing a lattice line $\ell$ as a sequence $\ell_1, \ell_2, \ldots$ of links (Figure \ref{fig:line}),
\begin{figure}[!htb]
    \centering
    \rule{3in}{1.5in}
    \caption{Generic lattice Wilson line}
    \label{fig:line}
\end{figure}
the Wilson line evaluated over $\ell$ is simply given by the product of the correspondent links variables:
\begin{align*}
    U[\ell] &= e^{ig\int_\ell\mathrm dz_\mu\,A_\mu(z)} \\
            &= e^{ig\left[\int_{\ell_1}\mathrm dz_\mu\,A_\mu(z) + \int_{\ell_2}\mathrm dz_\mu\,A_\mu(z) + \cdots \right]} \\
            &= U[\ell_1]U[\ell_2] \cdots
\end{align*}

It remains to define the elementary gauge invariant object: the \emph{plaquette} Wilson loop.
A lattice plaquette is a grid square. Its sides are four links and its corners are four sites.
The shortest possible Wilson loop is a closed loop around a plaquette.
It has a very important physical relevance, and, to understand why,
it is necessary to express it in terms of the gauge fields.
Considering a link loop that starts from site $s$ and runs anticlockwise (Figure \ref{fig:plaq}),
the corresponding Wilson line is:
\begin{figure}[!htb]
    \centering
    \rule{3in}{1.5in}
    \caption{Plaquette Wilson loop}
    \label{fig:plaq}
\end{figure}
\begin{equation*}%\label{eq:plaq}
    \begin{aligned}
        \Pi_{\hat x\hat y}(s) &\equiv U_{\hat x}(s) U_{\hat y}(s+\hat x) U_{-\hat x}(s+\hat x+\hat y) U_{-\hat y}(s+\hat y) \\
                              &= U_{\hat x}(s) U_{\hat y}(s+\hat x) U^*_{\hat x}(s+\hat y) U^*_{\hat y}(s) \\
                              &= e^{iga[A_1(s+\hat x/2) + A_2(s+\hat x+\hat y/2) - A_1(s+\hat x/2+\hat y) - A_2(s+\hat y/2)]+ \mathcal O\left(a^3\right)} \\
                              &= e^{iga^2[\partial_1A_1(s)/2 + \partial_1A_2(s) + \partial_2A_2(s)/2 - \partial_1A_1(s)/2 - \partial_2A_1(s) - \partial_2A_2(s)/2] %
                                    + \mathcal O\left(a^3\right)} \\
                              &= e^{ig\left[a^2F_{12}(s) + \mathcal O\left(a^3\right)\right]}
    \end{aligned}
\end{equation*}
If $a \to 0$, from the plaquette Wilson loop starting at site $s$, is then possible to recover the gauge field tensor evaluated at $s$.

\subsection*{Lattice action}

The continuum action \eqref{eq:cont_action}, depends quadratically on the gauge field tensor.
In order recover this dependence, it is useful to take the real part of the plaquette loop and expand it in terms of the field tensor:
\begin{align*}
    \Re\,\Pi_{\hat x\hat y}(s) &= \Re\,e^{ig\left[a^2F_{12}(s) + \mathcal O\left(a^3\right)\right]} \\
                                          &= \cos\left[ga^2F_{12}(s) + \mathcal O\left(a^3\right)\right] \\
                                          &= 1 - \frac{1}{2}g^2a^4F_{12}(s)^2 + \mathcal O\left(a^5\right) \\
                                          &= 1 - \frac{1}{4}g^2a^4F_{\mu\nu}(s)F_{\mu\nu}(s) + \mathcal O\left(a^5\right)
\end{align*}

The lattice action in terms of the link variables can be written in the following form:
\begin{equation}\label{eq:lat_action}
    \begin{aligned}
        S^L[U] \equiv \beta\sum_s\left(1-\Re\,\Pi_{\hat x\hat y}(s)\right)
    \end{aligned}
\end{equation}
In fact, using the fine lattice limit $a^2\sum_s \xrightarrow{a\to0} \int\mathrm d^2x$:
\[
    S^L = \beta\sum_s\frac{1}{4}g^2a^4F_{\mu\nu}(s)F_{\mu\nu}(s) + \mathcal O\left(a^5\right)
      \xrightarrow{a\to0} \beta g^2a^2\int\mathrm d^2x\,\frac{1}{4}F_{\mu\nu}(x)F_{\mu\nu}(x)
\]
Thus, if the $\beta$ parameter is set to $\beta \equiv 1/(g^2a^2)$,
the lattice action converges to the continuum action of Equation \eqref{eq:cont_action}.

\subsection*{Monte Carlo simulations and continuum limit}

Equation \eqref{eq:cont_exp} gives the expectation value of an observable $\mathcal O[A]$.
If it is possible to define an operator $\mathcal O^L$ in terms of the link variables such that $\mathcal O^L[U] \xrightarrow{a\to0} \mathcal O[A]$,
the lattice variant of the expectation value will be:
\begin{equation}\label{eq:lat_exp}
    \left<\mathcal O[U]\right>_L \equiv \frac{\int[\mathrm dU]\, \mathcal O[U] e^{-S^L[U]}}{\int[\mathrm dU]\,e^{-S^L[U]}}
\end{equation}
Here, the dynamical variables are the lattice links $U \in U(1)$, and $dU$ is the Haar measure of $U(1)$.

It is useful to describe the problem with concepts of \emph{probability theory}:
$\mathcal O[U]$ can be seen as a function of random variables $\{U\}$ that follow a probability density function proportional to $e^{-S^L[U]}$,
and the mean value of $\mathcal O[U]$ corresponds to the expectation value of Equation \eqref{eq:lat_exp}.

To compute $\left<\mathcal O[U]\right>_L$, the most common strategy employs Monte Carlo algorithms.
The procedure is organized in these steps:
\begin{itemize}
    \item The physical system has to be implemented on a computer: dynamical variables are stored in computer memory,
        and appropriate functions are defined to evaluate the action and other physical observables in terms of the dynamical variables.
        This step will be discussed in Chapter \ref{ch:lattice}.
    \item A sequence of dynamical variable configurations is generated in agreement with the weight function $e^{-S^L}$, and, at each step,
        the observables are evaluated in the current configuration and stored in computer memory. The details will be explained in Chapter \ref{ch:local}.
    \item The average of the stored values is computed, and, for the law of large numbers,
        it converges to the value of Equation \ref{eq:lat_exp} if the sequence is long enough.
\end{itemize}

However, the lattice expectation value \eqref{eq:lat_exp} converges to the value in the continuum \eqref{eq:cont_exp} only in the limit of infinitesimal lattice:
\[
    \left<\mathcal O^L[U]\right>_L \xrightarrow{a\to0} \left<\mathcal O[A]\right>_E
\]
and this limit is not achievable on a computer because it would imply to operate on an infinite number of dynamical variables.
Two \emph{cutoffs} are then necessary: a finite lattice spacing $a$ (ultraviolet cutoff),
and a finite volume, \ie a finite number $N$ of lattice sites along every direction (infrared cutoff).
Usually, the finite volume is implemented with periodic boundary conditions, because ... 
\marginpar{Chiedere chiarimenti sulle condizioni periodiche. Riducono il bias dovuto al volume finito?}

To recover the continuum limit and the infinite volume e limit,
it is necessary to evaluate the expectation value at different parameter values in order to extrapolate the limits.
In quantum field theories, this is in general a complicated problem,
since theory parameters have to be renormalized and their value depends on the energy cutoff.

Considering the space to be a finite sized cubic box with a side of length $L=Na$,
the continuum limit is evaluated performing diffent simulations with different values of $N$, changing $a$ accordingly in order to maintain $L$ fixed.
In the considered theory, the action \eqref{eq:lat_action} depends on $a$ implicitly through the parameter $\beta = 1/(g^2a^2)$.

In general, if the coupling constant $g$ needs to be renormalized,
the renormalization group equations establish for $g$ a non-trivial dependence on the lattice spacing (\emph{running coupling constant}).
If the theory exhibit asymptotic freedom (like QCD, for example), the continuum limit dependence of $g(a)$ can be studied perturbatively computing the $\beta_L$ function:
\[
    \beta_L(g) \equiv -a\frac{\partial g}{\partial a}
\]

However, for the two dimensional $U(1)$ gauge theory, the $\beta_L$ function is zero, and the coupling constant $g$ is then independent from the lattice spacing $a$.
Thus, the action parameter $beta$ dependence on $a$ is:
\begin{equation}
    \begin{aligned}
        \beta &\propto a^{-2} \\
              &\propto 
    \end{aligned}
\end{equation}



To evaluate the continuum limit, simulations are perfomed in a constant and finite sized box of lenght $L=Na$.
The 

The infinite volume limit will not be treated in this work, since the topological freezing affects only the extrapolation of the continuum limit.









%*****************************************
%*****************************************
%*****************************************
%*****************************************
%*****************************************
